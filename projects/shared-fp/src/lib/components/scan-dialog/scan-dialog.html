<p-dialog
  [visible]="visible()"
  (visibleChange)="visible.set($event)"
  [modal]="true"
  [style]="{ width: '90vw', maxWith: '500px' }"
>
  <ng-template #header>Scan QR Code</ng-template>
  @if (!visible()) {
  <!-- Content destroyed when dialog is closed -->
  } @else if (isLoading()) {
  <div class="loading">
    <p-progress-spinner ariaLabel="loading" [style]="{ width: '40px', height: '40px' }" />
  </div>
  } @else { @if (availableCameras().length > 0) {
  <div class="flex flex-col gap-4 items-center">
    <p-select
      [options]="availableCameras()"
      [(ngModel)]="selectedCameraId"
      optionValue="deviceId"
      optionLabel="label"
      placeholder="Select a camera"
      class="w-full sm:w-90"
    />

    <lib-qr-scanner
      [deviceId]="selectedCameraId()"
      (qrCodeScanned)="onQrCodeScanned($event)"
      (scanCancelled)="cancel()"
      (scanError)="onScanError($event)"
    />
  </div>
  } }
</p-dialog>
